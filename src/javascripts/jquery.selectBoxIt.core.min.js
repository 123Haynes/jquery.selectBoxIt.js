(function(a){"use strict",a(jQuery,window,document)})(function(a,b,c,d){"use strict",a.widget("selectBox.selectBoxIt",{VERSION:"1.2.0",options:{showEffect:"none",showEffectOptions:{},showEffectSpeed:"medium",hideEffect:"none",hideEffectOptions:{},hideEffectSpeed:"medium",showFirstOption:!0,defaultText:"",defaultIcon:"",downArrowIcon:"",theme:"twitterbootstrap",keydownOpen:!0},_create:function(){this.originalElem=this.element[0],this.selectBox=this.element,this.selectItems=this.element.find("option"),this.firstSelectItem=this.element.find("option").slice(0,1),this.currentFocus=0,this.blur=!0,this.documentHeight=a(c).height(),this.textArray=[],this.currentIndex=0,this.flipped=!1,this._createDiv(),this._createUnorderedList(),this._replaceSelectBox(),this._eventHandlers(),this.originalElem.disabled&&this.disable&&this.disable(),this._ariaAccessibility&&this._ariaAccessibility(),this.options.theme==="twitterbootstrap"?this._twitterbootstrap():this.options.theme==="jqueryui"?this._jqueryui():this._addClasses(),this.selectBox.trigger("create")},_createDiv:function(){return this.divText=a("<span/>",{id:this.originalElem.id+"SelectBoxItText","class":"selectboxit-text",unselectable:"on",text:this.firstSelectItem.text()}).attr("data-val",this.originalElem.value),this.divImage=a("<i/>",{id:this.originalElem.id+"SelectBoxItDefaultIcon","class":"selectboxit-default-icon",unselectable:"on"}),this.div=a("<div/>",{id:this.originalElem.id+"SelectBoxIt","class":"selectboxit",name:this.originalElem.name,tabindex:0,unselectable:"on"}).append(this.divImage).append(this.divText),this.divContainer=a("<div/>",{id:this.originalElem.id+"SelectBoxItContainer","class":"selectboxit-container"}).append(this.div),this},_createUnorderedList:function(){var b=this,c,d="",e="",f,g="",h=a("<ul/>",{id:this.originalElem.id+"SelectBoxItOptions","class":"selectboxit-options",tabindex:-1});return this.options.showFirstOption||(this.selectItems=this.selectBox.find("option").slice(1)),this.selectItems.each(function(h){c=a(this).prop("disabled"),f=a(this).data("icon")||"",a(this).parent().is("optgroup")?(d="selectboxit-optgroup-option",a(this).index()===0?e='<div class="selectboxit-optgroup-header" data-disabled="true">'+a(this).parent().first().attr("label")+"</div>":e=""):d="",g+=e+'<li id="'+h+'" data-val="'+this.value+'" data-disabled="'+c+'" class="'+d+'"><a><i class="'+f+'"></i>'+a(this).text()+"</a></li>",b.textArray[h]=a(this).text(),this.selected&&(b.divText.text(a(this).text()),b.currentFocus=h)}),b.options.defaultText&&b.divText.text(b.options.defaultText),b.selectBox.data("text")&&(b.divText.text(b.selectBox.data("text")),b.options.defaultText=b.selectBox.data("text")),h.append(g),this.list=h,this.divContainer.append(this.list),this.listItems=this.list.find("li"),this.list.find("li[data-disabled='true']").not(".optgroupHeader").addClass("ui-state-disabled"),this.currentFocus===0&&!this.options.showFirstOption&&this.listItems.eq(0).hasClass("ui-state-disabled")&&(this.currentFocus=+this.listItems.not(".ui-state-disabled").first().attr("id")),this.divImage.addClass(this.selectBox.data("icon")||this.options.defaultIcon||this.listItems.eq(this.currentFocus).find("i").attr("class")),this},_replaceSelectBox:function(){this.selectBox.css("display","none").after(this.divContainer);var b=this.div.height();return this.downArrow=a("<i/>",{id:this.originalElem.id+"SelectBoxItArrow","class":"selectboxit-arrow",unselectable:"on"}),this.downArrowContainer=a("<span/>",{id:this.originalElem.id+"SelectBoxItArrowContainer","class":"selectboxit-arrow-container",unselectable:"on",style:"height:"+b+"px;"}).append(this.downArrow),this.div.append(this.downArrowContainer),this.divText.css({"line-height":this.div.css("height"),"max-width":this.div.width()-(this.downArrowContainer.width()+this.divImage.width())-5}),this.divImage.css({"margin-top":b/4}),this},_scrollToView:function(a){var b=this.list.scrollTop(),c=this.listItems.eq(this.currentFocus).height(),d=this.listItems.eq(this.currentFocus).position().top,e=this.list.height();return a==="search"?e-d<c?this.list.scrollTop(b+(d-(e-c))):d<-1&&this.list.scrollTop(d-c):a==="up"?d<-1&&this.list.scrollTop(b-Math.abs(this.listItems.eq(this.currentFocus).position().top)):a==="down"&&e-d<c&&this.list.scrollTop(b+(Math.abs(this.listItems.eq(this.currentFocus).position().top)-e+c)),this},_callbackSupport:function(b){a.isFunction(b)&&b.call(this,this.div)},open:function(a){if(!this.list.is(":visible")){var b=this;this.selectBox.trigger("open"),this._dynamicPositioning&&this._dynamicPositioning();switch(this.options.showEffect){case"none":this.list.show(),this._scrollToView("search");break;case"show":this.list.show(this.options.showEffectSpeed,function(){b._scrollToView("search")});break;case"slideDown":this.list.slideDown(this.options.showEffectSpeed,function(){b._scrollToView("search")});break;case"fadeIn":this.list.fadeIn(this.options.showEffectSpeed),this._scrollToView("search");break;default:this.list.show(this.options.showEffect,this.options.showEffectOptions,this.options.showEffectSpeed,function(){b._scrollToView("search")})}}return this._callbackSupport(a),this},close:function(a){if(this.list.is(":visible")){var b=this;this.selectBox.trigger("close");switch(this.options.hideEffect){case"none":this.list.hide(),this._scrollToView("search");break;case"hide":this.list.hide(this.options.hideEffectSpeed);break;case"slideUp":this.list.slideUp(this.options.hideEffectSpeed);break;case"fadeOut":this.list.fadeOut(this.options.hideEffectSpeed);break;default:this.list.hide(this.options.hideEffect,this.options.hideEffectOptions,this.options.hideEffectSpeed,function(){b._scrollToView("search")})}}return this._callbackSupport(a),this},_eventHandlers:function(){var b=this,c=38,d=40,e=13,f=8,g=9,h=32,i=27;return this.div.bind({"click.selectBoxIt":function(){a(":focus").is(b.div)||a(this).focus(),b.originalElem.disabled||(b.selectBox.trigger("click"),b.list.is(":visible")?b.close():b.open())},"mousedown.selectBoxIt":function(){a(this).data("mdown",!0)},"blur.selectBoxIt":function(){b.blur&&(b.selectBox.trigger("blur").trigger("focusout"),b.list.is(":visible")&&b.close())},"focus.selectBoxIt":function(){var c=a(this).data("mdown");a(this).removeData("mdown"),c||b.selectBox.trigger("tab-focus"),b.list.is(":visible")||b.selectBox.trigger("focus").trigger("focusin")},"keydown.selectBoxIt":function(h){var j=h.keyCode;if(a(":focus").is(b.div))switch(j){case d:h.preventDefault(),b.moveDown&&(b.options.keydownOpen?b.list.is(":visible")?b.moveDown():b.open():b.moveDown()),b.options.keydownOpen&&b.open();break;case c:h.preventDefault(),b.moveUp&&(b.options.keydownOpen?b.list.is(":visible")?b.moveUp():b.open():b.moveUp()),b.options.keydownOpen&&b.open();break;case e:h.preventDefault(),b.list.is(":visible")&&b.close(),(!b.options.showFirstOption&&b.div.text()===b.firstSelectItem.text()&&b.currentFocus===0||b.options.showFirstOption&&b.options.defaultText||!b.options.showFirstOption&&!b.listItems.eq(0).not("[data-disabled='true']"))&&b.selectBox.val(b.listItems.eq(b.currentFocus).attr("data-val")).trigger("change"),b.selectBox.trigger("enter");break;case g:b.selectBox.trigger("tab-blur");break;case f:h.preventDefault(),b.selectBox.trigger("backspace");break;case i:b.close();break;default:}},"keypress.selectBoxIt":function(c){if(a(":focus").is(b.div)){var d=c.charCode||c.keyCode,e=String.fromCharCode(d);d===h&&c.preventDefault(),b.search&&b.search(e,!0,"")}},"mouseenter.selectBoxIt":function(){b.selectBox.trigger("mouseenter")},"mouseleave.selectBoxIt":function(){b.selectBox.trigger("mouseleave")}}),this.list.bind({"mouseover.selectBoxIt":function(){b.blur=!1},"mouseout.selectBoxIt":function(){b.blur=!0},"focusin.selectBoxIt":function(){b.div.focus()}}).delegate("li","click.selectBoxIt",function(){a(this).data("disabled")||(b.originalElem.value=a(this).attr("data-val"),b.currentFocus=+this.id,b.close(),b.originalElem.value!==b.divText.attr("data-val")&&b.selectBox.trigger("change"),b.selectBox.trigger("option-click"))}).delegate("li","focus.selectBoxIt",function(){a(this).data("disabled")||(b.originalElem.value=a(this).attr("data-val"),b.originalElem.value!==b.divText.attr("data-val")&&b.selectBox.trigger("change"))}),this.selectBox.bind({"change.selectBoxIt":function(){b.divText.text(b.listItems.eq(b.currentFocus).text()).attr("data-val",b.originalElem.value),b.listItems.eq(b.currentFocus).find("i").attr("class")&&b.divImage.attr("class",b.listItems.eq(b.currentFocus).find("i").attr("class")).addClass("selectboxit-default-icon")},"disable.selectBoxIt":function(){b.div.addClass("ui-state-disabled")},"enable.selectBoxIt":function(){b.div.removeClass("ui-state-disabled")}}),this},_addClasses:function(b,c,d,e,f){var g=this,h=b||"selectboxit-focus",i=c||"selectboxit-hover",j=e||"selectboxit-btn",k=f||"selectboxit-dropdown";return this.downArrow.addClass(this.selectBox.data("downarrow")||this.options.downArrowIcon||d),this.div.addClass(e).css("padding","0px"),this.list.addClass(f).css({top:"auto",bottom:"auto",left:"auto",right:"auto"}),this.listItems.bind({"focus.selectBoxIt":function(){a(this).addClass(h)},"blur.selectBoxIt":function(){a(this).removeClass(h)}}),this.selectBox.bind({"open.selectBoxIt":function(){g.div.removeClass(i).add(g.listItems.eq(g.currentFocus)).addClass(h)},"blur.selectBoxIt":function(){g.div.removeClass(h)},"mouseenter.selectBoxIt":function(){g.div.addClass(i)},"mouseleave.selectBoxIt":function(){g.div.removeClass(i)}}),this.listItems.bind({"mouseenter.selectBoxIt":function(){g.listItems.removeClass(h),a(this).addClass(i)},"mouseleave.selectBoxIt":function(){a(this).removeClass(i)}}),this.options.theme==="twitterbootstrap"&&d==="caret"?this.downArrow.css({"margin-top":this.downArrowContainer.height()/2}):this.downArrow.css({"margin-top":this.downArrowContainer.height()/4}),this},_jqueryui:function(){this._addClasses("ui-state-focus","ui-state-hover","ui-icon ui-icon-triangle-1-s","ui-widget ui-state-default","ui-widget ui-widget-content")},_twitterbootstrap:function(){this._addClasses("active","","caret","btn","dropdown-menu")},destroy:function(b){return this.div.unbind(".selectBoxIt").undelegate(".selectBoxIt"),this.divContainer.remove(),this.selectBox.trigger("destroy").show(),a.Widget.prototype.destroy.call(this),this._callbackSupport(b),this},refresh:function(a){return this.destroy(function(){this._create()}),this}})});
(function(c,p,q,l){var o=function(g,m,k){var a={originalElem:g,selectBox:c(g),selectItems:c(g).find("option"),firstSelectItem:c(g).find("option").slice(0,1),currentFocus:0,blur:!0,documentHeight:c(q).height(),textArray:[],currentIndex:0,currentText:"",options:m,divContainer:null,div:null,divText:null,list:null,listItems:null,downArrow:null,downArrowContainer:null,flipped:!1},o=function(){a.divText=c("<span/>",{id:a.originalElem.id+"SelectBoxItText",unselectable:"on",text:a.firstSelectItem.text()});
a.div=c("<div/>",{id:a.originalElem.id+"SelectBoxIt",name:a.originalElem.name,tabindex:0}).append(a.divText);a.divContainer=c("<div/>",{id:a.originalElem.id+"SelectBoxItContainer"}).append(a.div);return this},x=function(){var b="",h=c("<ul/>",{id:a.originalElem.id+"SelectBoxItOptions",tabindex:-1});a.options.showFirstOption||(a.selectItems=a.selectBox.find("option").slice(1));a.selectItems.each(function(h){b=b+('<li id="'+h+'">'+c(this).text()+"</li>");a.textArray[h]=c(this).text();if(this.selected){a.divText.text(c(this).text());
a.currentFocus=h}});h.append(b);a.list=h;a.divContainer.append(a.list);a.listItems=a.list.find("li");return this},y=function(){a.selectBox.css("display","none").after(a.divContainer);var b=a.div.height();a.downArrow=c("<span/>",{id:a.originalElem.id+"SelectBoxItArrow",unselectable:"on",style:"margin-top:"+b/2+";"});a.downArrowContainer=c("<span/>",{id:a.originalElem.id+"SelectBoxItArrowContainer",unselectable:"on",style:"height:"+b+"px;"}).append(a.downArrow);a.div.append(a.downArrowContainer);a.divText.css({"line-height":a.div.css("height"),
"max-width":a.div.width()-a.downArrowContainer.width()-5});return this},e=function(b){var c=a.list.scrollTop(),f=a.listItems.eq(a.currentFocus).height(),i=a.listItems.eq(a.currentFocus).position().top,d=a.list.height();"search"===b?d-i<f?a.list.scrollTop(c+(i-(d-f))):-1>i&&a.list.scrollTop(i-f):"up"===b?-1>i&&a.list.scrollTop(c-f):"down"===b&&d-i<f&&a.list.scrollTop(c+f);return this},z=function(){var b=a.div.offset().top,h=a.list.height(),f=a.div.height();b+f+h>=c(p).height()+c(p).scrollTop()&&0<=
b-h?a.flipped||(a.list.css("top",a.divContainer.position().top-a.list.height()-2),a.flipped=!0):a.flipped&&(a.list.css("top",a.divContainer.position().top+a.div.height()+2),a.flipped=!1)},d=function(b){c.isFunction(b)&&b.call(c(a.originalElem).data(k),a.div)},r=function(b){a.selectBox.trigger("open");z();switch(a.options.showEffect){case "none":a.list.show();e("search");break;case "show":a.list.show(a.options.showEffectSpeed,function(){e("search")});break;case "slideDown":a.list.slideDown(a.options.showEffectSpeed,
function(){e("search")});break;case "fadeIn":a.list.fadeIn(a.options.showEffectSpeed);e("search");break;default:a.list.is(":visible")||a.list.show(a.options.showEffect,a.options.showEffectOptions,a.options.showEffectSpeed,function(){e("search")})}d(b);return this},j=function(b){a.selectBox.trigger("close");switch(a.options.hideEffect){case "none":a.list.hide();e("search");break;case "hide":a.list.hide(a.options.hideEffectSpeed);break;case "slideUp":a.list.slideUp(a.options.hideEffectSpeed);break;
case "fadeOut":a.list.fadeOut(a.options.hideEffectSpeed);break;default:a.list.is(":visible")&&a.list.hide(a.options.hideEffect,a.options.hideEffectOptions,a.options.hideEffectSpeed,function(){e("search")})}d(b);return this},s=function(b){a.currentFocus+=1;a.currentFocus===a.listItems.length?a.currentFocus-=1:(a.listItems.eq(a.currentFocus-1).blur().end().eq(a.currentFocus).focus(),e("down"),a.selectBox.trigger("moveDown"));d(b);return this},t=function(b){a.currentFocus-=1;0>a.currentFocus||0===a.currentFocus&&
!a.options.showFirstOption?a.currentFocus+=1:(a.listItems.eq(a.currentFocus+1).blur().end().eq(a.currentFocus).focus(),e("up"),a.selectBox.trigger("moveUp"));d(b);return this},n=function(b){if(0!==b||a.options.showFirstOption)a.divText.text(a.textArray[b]),a.listItems.eq(a.currentFocus).blur(),a.currentIndex=b,a.currentFocus=b,a.listItems.eq(a.currentFocus).focus(),e("search");return this},u=function(b,c){var f=!1,d,e,g;d=b;for(g=a.textArray.length;d<g;d+=1){for(e=0;e<g;e+=1)-1!==a.textArray[e].search(c)&&
(f=!0,e=g);f||(a.currentText=a.currentText.charAt(a.currentText.length-1).replace(/[|()\[{.+*?$\\]/g,"\\$0"),c=RegExp(a.currentText,"gi"));if(2>a.currentText.length){if(-1!==a.textArray[d].charAt(0).search(c))return n(d),a.currentIndex+=1,a.selectBox.trigger("search"),!1}else if(-1!==a.textArray[d].search(c))return n(d),a.selectBox.trigger("search"),!1;if(a.textArray[d].toLowerCase()===a.currentText.toLowerCase())return n(d),a.currentText="",a.selectBox.trigger("search"),!1}return!0},v=function(b,
c,f){a.currentText=c?a.currentText+b.replace(/[|()\[{.+*?$\\]/g,"\\$0"):b.replace(/[|()\[{.+*?$\\]/g,"\\$0");b=RegExp(a.currentText,"gi");u(a.currentIndex,b)&&u(0,b);d(f);return this},A=function(){a.div.bind({"click.selectBoxIt":function(){a.originalElem.disabled||(a.selectBox.trigger("click"),a.list.is(":visible")?j():r())},"mousedown.selectBoxIt":function(){c(this).data("mdown",!0)},"blur.selectBoxIt":function(){a.blur&&(a.selectBox.trigger("blur").trigger("focusout"),a.list.is(":visible")&&j())},
"focus.selectBoxIt":function(b,d){var f=c(this).data("mdown");c(this).removeData("mdown");!d&&!f&&a.selectBox.trigger("tabFocus");d||a.selectBox.trigger("focus").trigger("focusin")},"keydown.selectBoxIt":function(b){var c=b.keyCode;if(a.div.is(":focus"))switch(c){case 40:b.preventDefault();a.options.keyboardNavigation&&s();break;case 38:b.preventDefault();a.options.keyboardNavigation&&t();break;case 13:b.preventDefault();a.list.is(":visible")&&j();!a.options.showFirstOption&&a.div.text()===a.firstSelectItem.text()&&
0===a.currentFocus&&a.selectBox.val(a.listItems.eq(a.currentFocus).text()).trigger("change");a.selectBox.trigger("enter");break;case 9:a.selectBox.trigger("tabBlur");break;case 8:b.preventDefault(),a.selectBox.trigger("backspace")}},"keypress.selectBoxIt":function(b){if(a.div.is(":focus")){var c=b.charCode||b.keyCode,d=String.fromCharCode(c);32===c&&b.preventDefault();a.options.keyboardSearch&&v(d,!0,"")}},"mouseenter.selectBoxIt":function(){a.selectBox.trigger("mouseenter")},"mouseleave.selectBoxIt":function(){a.selectBox.trigger("mouseleave")},
destroy:function(){c.removeData(a.selectBox[0],k)}});a.div.add(a.divText).add(a.downArrow).add(a.downArrowContainer).bind({"click.selectBoxIt":function(){a.div.is(":focus")||a.div.trigger("focus",!0)}});a.list.bind({"mouseover.selectBoxIt":function(){a.blur=!1},"mouseout.selectBoxIt":function(){a.blur=!0},"focusin.selectBoxIt":function(){a.div.trigger("focus",!0)}}).delegate("li","click.selectBoxIt",function(){a.originalElem.value=c(this).text();a.currentFocus=+this.id;j();a.originalElem.value!==
a.divText.text()&&a.selectBox.trigger("change")}).delegate("li","focus.selectBoxIt",function(){a.originalElem.value=c(this).text();a.selectBox.trigger("change")});a.selectBox.bind({"change.selectBoxIt":function(){a.divText.text(this.value)},"disable.selectBoxIt":function(){a.div.addClass("ui-state-disabled")},"enable.selectBoxIt":function(){a.div.removeClass("ui-state-disabled")}});return this},B=function(){a.div.attr({role:"combobox","aria-autocomplete":"list","aria-expanded":"false","aria-owns":a.list.attr("id"),
"aria-activedescendant":a.listItems.eq(a.currentFocus).attr("id"),"aria-label":c("label[for='"+a.originalElem.id+"']").text()||"","aria-live":"assertive"}).bind({"disable.selectBoxIt":function(){a.div.attr("aria-disabled","true")},"enable.selectBoxIt":function(){a.div.attr("aria-disabled","false")}});a.list.attr({role:"listbox","aria-hidden":"true"});a.listItems.attr({role:"option"});a.selectBox.bind({"change.selectBoxIt":function(){a.divText.attr("aria-label",a.originalElem.value)},"open.selectBoxIt":function(){a.list.attr("aria-hidden",
"false");a.div.attr("aria-expanded","true")},"close.selectBoxIt":function(){a.list.attr("aria-hidden","true");a.div.attr("aria-expanded","false")}});return this},w=function(b){j();a.selectBox.trigger("disable").attr("disabled","disabled");a.div.removeAttr("tabindex").css("cursor","default");d(b);return this},C=function(){a.originalElem.disabled&&w();return this},D=function(){a.div.addClass("ui-widget ui-state-default");a.list.addClass("ui-widget ui-widget-content");a.listItems.bind({"focus.selectBoxIt":function(){c(this).addClass("ui-state-focus")},
"blur.selectBoxIt":function(){c(this).removeClass("ui-state-focus")}});a.selectBox.bind({"open.selectBoxIt":function(){a.div.removeClass("ui-state-hover").add(a.listItems.eq(a.currentFocus)).addClass("ui-state-focus")},"blur.selectBoxIt":function(){a.div.removeClass("ui-state-focus")},"mouseenter.selectBoxIt":function(){a.div.addClass("ui-state-hover")},"mouseleave.selectBoxIt":function(){a.div.removeClass("ui-state-hover")}});a.listItems.bind({"mouseenter.selectBoxIt":function(){a.listItems.removeClass("ui-state-focus ui-state-hover");
c(this).addClass("ui-state-hover")},"mouseleave.selectBoxIt":function(){c(this).removeClass("ui-state-hover")}});a.downArrow.addClass("ui-icon ui-icon-triangle-1-s").css({"margin-top":a.downArrowContainer.height()/3});return this};return{version:"0.1.0",self:a,open:r,close:j,moveDown:s,moveUp:t,search:v,getOption:function(b,c){d(c);return a.options[b]||l},getOptions:function(b){d(b);return a.options||l},setOption:function(b,c,e){a.options[b]!==l&&(a.options[b]=c);"showFirstOption"===b&&!c?a.listItems.eq(0).hide():
"showFirstOption"===b&&c&&a.listItems.eq(0).show();d(e);return this},setOptions:function(b,e){c.isPlainObject(b)&&(a.options=c.extend({},a.options,b));a.options.showFirstOption?a.listItems.eq(0).show():a.listItems.eq(0).hide();d(e);return this},disable:w,enable:function(b){a.selectBox.trigger("enable").removeAttr("disabled");a.div.attr("tabindex",0).css("cursor","pointer");d(b);return this},destroy:function(b){a.div.unbind(".selectBoxIt").undelegate(".selectBoxIt");a.div.trigger("destroy");a.divContainer.remove();
a.selectBox.trigger("destroy").show();d(b);return this},create:function(b){c(g).is(":visible")&&(o(),x(),y(),A(),C(),B(),D(),a.selectBox.trigger("create"),d(b));return this}}};c.fn.selectBoxIt=function(g){return this.each(function(){var m=c(this),k;c.data(m[0],"selectBoxIt")||(g=c.extend({},c.fn.selectBoxIt.options,g),k=(new o(this,g,"selectBoxIt")).create(),c.data(m[0],"selectBoxIt",k),c.extend(c.expr[":"],{focus:function(a){return a===q.activeElement},selectBoxIt:function(a){return c(a).data("selectBoxIt")!==
l}}))})};c.fn.selectBoxIt.options={showEffect:"none",showEffectOptions:{},showEffectSpeed:"medium",hideEffect:"none",hideEffectOptions:{},hideEffectSpeed:"medium",keyboardSearch:!0,keyboardNavigation:!0,showFirstOption:!0}})(jQuery,window,document);